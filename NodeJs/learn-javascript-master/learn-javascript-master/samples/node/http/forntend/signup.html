<!DOCTYPE html>
<html lang="en" class="no-js">

<head>
	<meta charset="UTF-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>印有为云打印后台管理系统</title>
	<link rel="stylesheet" type="text/css" href="css/normalize.css" />
	<link rel="stylesheet" type="text/css" href="css/demo.css" />
	<!--必要样式-->
	<link rel="stylesheet" type="text/css" href="css/component.css" />
	<!--[if IE]>
<script src="js/html5.js"></script>
<![endif]-->
</head>

<body>
	<div class="container demo-1">
		<div class="content">
			<div id="large-header" class="large-header">
				<canvas id="demo-canvas"></canvas>
				<div class="logo_box">
					<h3>注册账号</h3>
					<form name="f" method="post">
						<div class="input_outer" id="yzn">
							<span class="u_user"></span>
							<input name="logname" class="text" id="username" style="color: #FFFFFF !important"
								type="text" placeholder="请输入手机号" onkeyup="checkPhone()"><span id="tel"
								style="margin-left:-55px; "></span>
						</div>
						<div class="input_outer">
							<span class="us_uer"></span>
							<input name="logpass" class="text"
								style="color: #FFFFFF !important; position:absolute; z-index:100;" value=""
								type="password" id="password" placeholder="请输入密码">
						</div>
						<div class="input_outer">
							<span class="us_uer"></span>
							<input name="logpass2" class="text"
								style="color: #FFFFFF !important; position:absolute; z-index:100;" value=""
								type="password" id="password2" placeholder="请确认密码" onblur="validate()"><span id="tishi"
								style="margin-left:200px; margin-top: 12px; display: inline-block;"></span>
						</div>
						<div class="input_outer_ucode" id="yzm">
							<span class="us_ucode"></span>
							<input name="ucode" type="text" class="text_code"
								style="color: #FFFFFF !important; position:absolute; z-index:100;" placeholder="手机验证码"
								id="regist_vcode" />
							<input type="button" class="text_code_right"
								style="color: #FFFFFF !important; position:absolute;left:55%; z-index:100;"
								value="点击发送验证码" id="code" onclick="sendCode(this)" />
						</div>
						<div class="mb2"><a class="act-but submit" onclick="signup(this)" style="color: #FFFFFF">注册</a>
						</div>
					</form>
				</div>
			</div>
		</div>
	</div><!-- /container -->
	<script src="js/jquery-1.9.1.min.js"></script>
	<script src="js/TweenLite.min.js"></script>
	<script src="js/EasePack.min.js"></script>
	<script src="js/rAF.js"></script>
	<script src="js/demo-1.js"></script>
	<script type="text/javascript">
		function checkPhone() {
			var tel = $("#username").val();
			// 判断电话号码
			var rex = /^1[3456789]\d{9}$/;
			if (rex.test(tel)) {
				// return true;
				$("#tel").html("手机号正确");
				$("#tel").css("color", "green");
			} else {
				$("#tel").html("手机号不正确");
				$("#tel").css("color", "red")
				// return false;
			}
		}

		function validate() {
			var pwd = $("#password").val();
			var pwd1 = $("#password2").val();
			//  <!-- 对比两次输入的密码 -->
			if (pwd == pwd1) {
				$("#tishi").html("两次密码相同");
				$("#tishi").css("color", "green");
				$("#xiugai").removeAttr("disabled");
			} else {
				$("#tishi").html("两次密码不相同");
				$("#tishi").css("color", "red")
				$("button").attr("disabled", "disabled");
			}
		}
		// var url="http://192.168.31.229"
		function signup() {
			$.ajax({
				cache: false,
				type: "POST",
				dataType: "json",
				url: "http://192.168.31.200/users!register.do",
				data: {
					tel: $("#username").val(),
					password: $("#password").val(),
					password2: $("#password2").val(),
					code: $("#regist_vcode").val()
				},
				success: function (msg) {
					console.log(msg);
					// if (msg == "name_k") {
					// 	$("#yzn").html("*请输入手机号!");
					// 	return false;
					// } else {
					// 	$("#yzn").html("");
					// }
					// if (msg == "pass_k") {
					// 	$("#yzp").html("*请输入密码!");
					// 	return false;
					// } else {
					// 	$("#yzp").html("");
					// }
					// if (msg == "fail") {
					// 	$("#yzn").html("*用户名或密码错误!");
					// 	return false;
					// } else {
					// 	$("#yzn").html("");
					// }
					if(msg.msg === "密码最小长度为8位!"){
						$("#tishi").html("密码最少为8位!");
						$("#tishi").css("color", "red")
					}else if (msg.state === '1') {
						// window.location.href = url + "index.html";
						window.location.href = "login.html";
					}
				}
			});
		}
		var clock = '';
		var nums = 60;
		var btn;

		function sendCode(thisBtn) {
			btn = thisBtn;
			btn.disabled = true; //将按钮置为不可点击
			btn.value = '重新获取（' + nums + '）';
			clock = setInterval(doLoop, 1000); //一秒执行一次
			$.ajax({
				cache: false,
				type: "POST",
				dataType: "json",
				contentType: "application/x-www-form-urlencoded",
				url: "http://192.168.31.200/telcode!getSMS.do",
				data: {
					tel: $("#username").val(),
					// password: $("#password").val()
				},
				success: function (msg) {
					console.log(msg);
				}
			});
		}

		function doLoop() {
			nums--;
			if (nums > 0) {
				btn.value = '重新获取（' + nums + '）';
			} else {
				clearInterval(clock); //清除js定时器
				btn.disabled = false;
				btn.value = '点击发送验证码';
				nums = 10; //重置时间
			}
		}

		// $(document).ready(function () {
		// 	$("#login_QQ").click(function () {
		// 		alert("暂停使用！");
		// 	});
		// 	$("#login_WB").click(function () {
		// 		alert("暂停使用！");
		// 	});
		// });
	</script>
	<div style="text-align:center;">
	</div>
</body>

</html>